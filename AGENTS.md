# Repository Guidelines

## Project Structure & Module Organization
- `app/`: Nuxt 4 client (pages, components, stores, composables, layouts). Static assets in `public/`; local styles in `app/assets/`.
- `server/`: API handlers in `server/api/` using Nitro file‑based routes (`*.get.ts`, `*.post.ts`; dynamic like `[username].get.ts`). Business logic in `server/services/`; DB schema in `server/db/schema.ts`; helpers in `server/utils/`.
- `shared/`: Cross‑isomorphic types, validators, and utilities used by both client and server.
- `migrations/`: Wrangler D1 SQL migrations (manual SQL; not generated by Drizzle).
- `types/`: Global TypeScript declarations. Build artifacts live in `.nuxt/` and `.output/` (do not edit).

## Build, Test, and Development Commands
- `pnpm dev`: Run Nuxt in development at `http://localhost:3000`.
- `pnpm build`: Build server and client; outputs to `.output/`.
- `pnpm preview`: Preview the built app locally from the build.
- `pnpm typecheck`: TypeScript checks via Nuxt.
- `pnpm lint` / `pnpm lint:fix`: Lint and auto‑fix with ESLint.
- DB: `pnpm db:migrate`, `pnpm db:reset`, `pnpm db:backup[:test|:prod]`.
- Deploy: `pnpm deploy:test` / `pnpm deploy:prod` (Cloudflare Workers; assets from `.output/public`).

## Coding Style & Naming Conventions
- Language: TypeScript (strict). Avoid `any`; unused vars are errors. Tests may use `any` (see `eslint.config.mjs`).
- API routes: `<name>.<method>.ts`; params in brackets (e.g., `server/api/budget/[username].get.ts`).
- Services: keep pure, framework‑free logic in `server/services/` ("Thin Handlers" pattern).
- Linting: Nuxt ESLint config is extended; run lint before pushing.

## Commit & Pull Request Guidelines
- Commits: follow Conventional Commits (`feat:`, `fix:`, `refactor:` …) consistent with repo history.
- PRs: include description, linked issues, repro steps, screenshots for UI, and notes on any DB migrations. Ensure `pnpm typecheck` and `pnpm lint` pass.

## Security & Configuration Tips
- Secrets: never commit `.env`. Use Wrangler secrets (`wrangler secret put JWT_SECRET --env="" | production`).
- D1: verify `wrangler.toml` DB IDs before deploy; test migrations locally with `pnpm db:migrate`. `pnpm db:reset` irreversibly wipes local data.

